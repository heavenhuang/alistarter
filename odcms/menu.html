<!DOCTYPE html>
<html>
    <head>
        <title>DCMS投放位曝光量展示插件菜单</title>
        <link rel="stylesheet" href="reset.css" />
        <meta charset="utf-8" />
    </head>
	<script type="text/javascript" src="jquery-1.7.2.min.js"></script>
	<script type="text/javascript">
		var xmlhttp;
		function loadXMLDoc(url)
		{
		xmlhttp=null;
		if (window.XMLHttpRequest)
		  {// code for Firefox, Opera, IE7, etc.
		  xmlhttp=new XMLHttpRequest();
		  }
		else if (window.ActiveXObject)
		  {// code for IE6, IE5
		  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
		  }
		if (xmlhttp!=null)
		  {
		  xmlhttp.onreadystatechange=callback;
		  xmlhttp.open("GET",url,true);
		  xmlhttp.send(null);
		  }
		else
		  {
		  alert("Your browser does not support XMLHTTP.");
		  }
		}

		function callback()
		{
		if (xmlhttp.readyState==4)
		  {// 4 = "loaded"
		  if (xmlhttp.status==200)
			{// 200 = "OK"
			//alert(xmlhttp.responseText);
			var  $px=xmlhttp.responseText;
			var _p =$($px);
			//alert(_p.html());
			//var px=eval('('+xmlhttp.responseText+')');
			//alert(px);
			document.getElementById('T1').innerHTML=_p.html();
			}
		  else
			{
			document.getElementById('T1').innerHTML=xmlhttp.responseText;
			//alert("Problem retrieving data:" + xmlhttp.status);
			}
		  }
		}
	</script>
    <body onload="loadXMLDoc('http://dcms.china.alibaba.com/open/pos/chromeplugin.html')">
        <style type="text/css">
        .menu-list { width:200px; height:58px; padding:8px;}
        .menu-list li { height:28px; line-height:28px; border-bottom:1px solid #d4d4d4; padding-left:8px; cursor:pointer;}
        .menu-list li.last-one {border-bottom:0;}
        </style>
        <ul class="menu-list">
            <li id="showPosData">查看页面位置数据</li>
			<li id="showPageClick">查看当前页面点击分布</li>
			<li class="last-one">版本：<span id="version">20120521</span> <a href="http://view.china.alibaba.com/cms/open/opendcms/contact.html" class="link">提供建议</a></li>
        </ul>
       
        <script type="text/javascript">
        ;(function($){
            $('#showPosData').click(function(e){
                chrome.tabs.query({highlighted:true,windowType:'normal'}, function(tabs){
                    var tabId = tabs[0].id;
                    chrome.tabs.sendRequest(tabId, 'posData', function(state){});
                });
            });
			$('#showPageClick').click(function(e){
                chrome.tabs.query({highlighted:true,windowType:'normal'}, function(tabs){
                    var tabId = tabs[0].id;
					var tabIndex = tabs[0].index;
					var nextTabIndex = tabIndex + 1;
                    chrome.tabs.sendRequest(tabId, 'pageClick', function(data){
						chrome.tabs.create({index:nextTabIndex,url:data.url});
					});
                });
            });
			$('.link').click(function(e){
				var $e = $(this); 
                chrome.tabs.query({highlighted:true,windowType:'normal'}, function(tabs){
                    var tabId = tabs[0].id;
					var tabIndex = tabs[0].index;
					var nextTabIndex = tabIndex + 1;
					var url = $e.attr("href");
					chrome.tabs.create({index:nextTabIndex,url:url});
                });
            });
			
        })(jQuery);
        </script>
    </body>
</html>